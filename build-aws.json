{
	"variables":
	{
		"image_name": "{{env `PACKER_IMAGE_NAME`}}",
		"source_image_id": "{{env `PACKER_SOURCE_IMAGE_ID`}}",
		"aws_access_key_id": "{{env `PACKER_AWS_ACCESS_KEY_ID`}}",
		"aws_secret_access_key": "{{env `PACKER_AWS_SECRET_ACCESS_KEY`}}",
		"region": "{{env `PACKER_REGION`}}",
        "current_version": "{{env `current_version`}}"
	},
    
	"builders": [
		{
			"type": "amazon-ebs",
            "access_key": "{{user `aws_access_key_id`}}",
            "ami_name": "{{user `image_name`}}",
            "ami_description": "{{user `image_name`}}",
            "ami_groups": "all",
            "ami_regions": ["ca-central-1", "eu-central-1", "eu-west-1", "eu-west-2", "us-east-1","us-east-2", "us-west-1", "us-west-2"],
            "instance_type": "t2.medium",
            "region": "{{user `region`}}",
            "secret_key": "{{user `aws_secret_access_key`}}",
            "source_ami": "{{user `source_image_id`}}",          
            "ssh_username": "ubuntu"   
		}
	],
    
	"provisioners": [
		{
			"type": "shell",
			"script": "{{pwd}}/requirements.sh"
		}
	],
    "post-processors": [
        {
            "type": "shell-local",
            "script": "{{pwd}}/aws_pp.sh"
        }
    ]
}